# 8장 모션으로 파일 내부 탐색하기

- [8장 모션으로 파일 내부 탐색하기](#8장-모션으로-파일-내부-탐색하기)
  - [Tip.47 키보드 중앙에서 벗어나지 않고 타자 입력하기:w](#tip47-키보드-중앙에서-벗어나지-않고-타자-입력하기w)
    - [묶여있는 오른손 풀기](#묶여있는-오른손-풀기)
  - [Tip.48 실제 행과 표시 행 구분하기](#tip48-실제-행과-표시-행-구분하기)
    - [행 이동 명령 다시 설정하기](#행-이동-명령-다시-설정하기)
  - [Tip.49  단어 단위로 이동하기](#tip49--단어-단위로-이동하기)
    - [단어인지 WORD인지 파악하기](#단어인지-word인지-파악하기)
  - [Tip.50 이동을 위해 검색하기](#tip50-이동을-위해-검색하기)
    - [문자 검색에서 목표를 포함하거나 제외하기](#문자-검색에서-목표를-포함하거나-제외하기)
    - [스크래블 게임처럼 생각하기](#스크래블-게임처럼-생각하기)
  - [Tip.51  정밀 텍스트 객체로 선택 영역 추적하기](#tip51--정밀-텍스트-객체로-선택-영역-추적하기)
    - [검색 모션으로 조작하기](#검색-모션으로-조작하기)
  - [Tip.52 주변 삭제하기, 내부 변경하기](#tip52-주변-삭제하기-내부-변경하기)
    - [텍스트 객체로 오퍼레이터 사용하기](#텍스트-객체로-오퍼레이터-사용하기)
    - [토론](#토론)
  - [Tip.53 위치를 표시하고 그 위치로 이동하기](#tip53-위치를-표시하고-그-위치로-이동하기)
  - [Tip.54 위치를 표시하고 그 위치로 이동하기](#tip54-위치를-표시하고-그-위치로-이동하기)
    - [자동 위치 표시](#자동-위치-표시)
  - [Tip.55 괄호 넘나들기](#tip55-괄호-넘나들기)
    - [키워드 사이 이동하기](#키워드-사이-이동하기)

Vim 문서인 `:h motion.txt`로 모든 모션을 살펴볼 수 있다.

## Tip.47 키보드 중앙에서 벗어나지 않고 타자 입력하기:w

- h: 한 열 좌측 이동
- l: 한 열 우측 이동
- j: 한 행 하단 이동
- k: 한 행 상단 이동

이런 키 배치는 전례에 따른 것이기 때문에 여기서 논리적인 이유를 찾으려고 하지 말자.

### 묶여있는 오른손 풀기

커서를 왼쪽으로 이동하는 데 h를 두 번 이상 누르는 것보다 더 편한 이동 방법이 있다.
수평으로 움직일 때는 단어 단위 모션, 문자 검색 모션 등을 활용하면 더 빠르게 이동할 수 있다.

## Tip.48 실제 행과 표시 행 구분하기

Vim에서는 줄바꿈(wrap) 설정이 기본적으로 활성화되어 있다.
행이 하나만 있더라도 여러 줄로 표시될 수 있는 것이다.

행 번호(number) 설정을 활성화하여 실제 행과 표시 행의 차이를 간단히 알아볼 수 있다.

`j`와 `k`는 실제 행을 기준으로 위아래로 이동한다.
`gj`와 `gk` 모션은 표시 행을 기준으로 위아래로 이동한다.

- j
  - 하나 아래로
  - 실제 행
- gj
  - 하나 아래료
  - 표시 행
- k
  - 하나 위로
  - 실제 행
  - 실제 행
- gk
  - 하나 위로
  - 표시 행
- O
  - 첫 문자로 이동
  - 실제 행
- gO
  - 첫 문자로 이동
  - 표시 행
- ^
  - 블럭이 아닌 첫 문자
  - 실제 행
- g^
  - 블럭이 아닌 첫 문자
  - 표시 행
- $
  - 행의 끝
  - 실제 행
- g$
  - 행의 끝
  - 표시 행

### 행 이동 명령 다시 설정하기

```vim
#motions/cursor-maps.vim
nnoremap k gk
nnoremap gk k
nnoremap j gj
nnoremap gj j
```

## Tip.49  단어 단위로 이동하기

- 단어(word) 단위 이동
- WORD 단위 이동
- `:h word-motions` 참고

- 단어의 첫 번째로 이동
  - `w`: 다음 단어의 시작 위치로 이동(for-ward)
  - `b`: 현재 단어의 시작 위치 또는 이전 단어의 시작 위치로 이동(back-word)
- 단어의 마지막으로 이동
  - `e`: 현재 단어의 마지막 위치 또는 다음 단어의 마지막 위치로 이동(end)
  - `ge`: 이전 단어의 마지막 위치로 이동

- `ea`: 현재 단어의 끝에 덧붙이라
- `gea`: 이전 단어의 끝에 덧붙이라

### 단어인지 WORD인지 파악하기

- 단어: 문자, 숫자, 밑줄(_) 또는 다른 블럭 아닌(nonblock) 문자의 연속으로 이뤄지고 공백으로 분리된 단위를 의미
  - `:h word`
- WORD: 블럭이 아닌 문자의 연속, 공백으로 분리된 경우.
  - `:h WORD`

```
e.g. we're going too slow
```

word(단어): e, ., g, ., we, ', re, going, too, slow (10)
WORD: e.g., we're, going, too, slow(5)

빠르게 이동하고 싶다면 WORD 단위로, 섬세하게 이동하고 싶다면 단어(word) 단위로 이동.
반복해서 사용하다 보면 원리를 직관적으로 습득할 수 있다.

## Tip.50 이동을 위해 검색하기

`f{문자}` 명령

- 특정 문자를 검색하는 명령
- 현재 커서 위치에서 현재 행의 끝까지를 범위로 검색
- 범위에서 일치하는 문자를 찾으면 커서가 그 특정 문자로 이동
- 일치하는 문자를 찾지 못하면 커서는 움직이지 않는다.
  - `:h f`
- `;` 명령을 사용해 마지막에 수행했던 검색을 반복할 수 있다.
- 위치를 다시 되돌리기 위해 `,` 명령을 사용할 수 있다.
  - `:h ,`

### 문자 검색에서 목표를 포함하거나 제외하기

- `f{문자}`: {문자}가 나타나는 다음 위치로 이동
- `F{문자}`: {문자}가 나타나는 이전 위치로 이동
- `t{문자}`: {문자}가 나타나는 다음 위치 앞으로 이동
- `T{문자}`: {문자}가 나타나는 이전 위치 앞으로 이동
- `;{문자}`: 마지막 문자 검색 명령을 정방향으로 반복
- `,{문자}`: 마지막 문자 검색 명령을 역방향으로 반복

일반 모드에서 `f{문자}`와 `F{문자}` 명령은 현재 행에서 빠르게 커서를 읻ㅇ하고 싶은 경우에도 자주 사용한다.

일반모드에서는 `f`, `F`를 주로 사용한다.
오퍼레이터-대기 모드에서는 `t`, `T`를 주로 사용한다.

### 스크래블 게임처럼 생각하기

Scrabble: 영문자 타일로 단어를 만드는 보드 게임의 일종

`f{문자}` 명령을 사용할 때 흔하지 않은 문자를 선택하는 습관을 기른다면 원하는 곳으로 한번에 이동할 가능성을 높일 수 있다.

문자 검색 명령을 사용할 때는 출현 빈도가 낮은 문자를 선택하는 것이 좋다.

## Tip.51  정밀 텍스트 객체로 선택 영역 추적하기

검색 명령을 이용하면 입력을 조금만 하더라도 거리에 상관없이 바로 이동할 수 있다.

```txt
#motions/search-haiku.txt
```

- `/ta<CR>`
- `/tak<CR>`

### 검색 모션으로 조작하기

1. `v`
   * 비주얼 모드로 변경
2. `/ge<CR>`
  * "ge" 문자를 찾아 선택 영역을 늘린다.
  * 커서는 off-by-one 오류가 난 걸 제외하면 원하는 영역에 얼추 맞아 들었다.
3. `h`
  * 선택 범위 중 한 글자를 줄인다.
4. `d`
  * 선택 범위의 영역을 삭제한다.

* `d/ge<CR>`
  * `d{모션}` 명령에서의 모션으로 `/ge<CR>` 검색 모션을 사용해서 해당 문장을 삭제하는 데 사용했다.

검색 모션과 `d{모션}` 동작을 사용하는 방식은 정말 강력하다.

## Tip.52 주변 삭제하기, 내부 변경하기

`motions/template.js`

Vim은 일정한 규칙을 준수하는 패턴 구조를 잘 이해한다. 이런 패턴 구조를 쉽게 영역으로 지정하고 내용을 수정할 수 있도록 텍스트 객체를 제공한다.

텍스트 객체는 패턴 구조로 정의한 본문 영역을 뜻한다. (`:h text-objects`)

* `vi}`
  * 비주얼 모드로 진입한 다음, {} 괄호 안에 있는 모든 문자를 선택 영역으로 진입했다.
  * 커서의 위치가 괄호 안이라면 어디에 있든지 상관없이 `i}`를 입력해서 텍스트 객체를 사용할 수 있다.
* `a"`
  * 겹따옴표로 감싼 범위로 선택영역을 확장한다.
* `i>`
  * 꺽쇠 괄호 안에 있는 모든 문자를 영역으로 지정한다.
* `it`
* `at`
* `a]`

Vim에서 텍스트 객체는 두 개의 문자로 구성되어 있으며, 첫 문자는 항상 i나 a로 시작한다.
i로 시작하는 텍스트 객체는 구분자 내에 있는 본문을 지정한다.
a를 사용하는 텍스트 객체는 구분자를 포함해서 선택 영역을 지정한다.
i: inside, a: around

`it`와 `at`의 차이에 유의하자.

a]가 범위를 확장할 때 여러 행에 걸쳐 동작했다는 점을 유의하자.

- `a)`, `ab`
  - 괄호 영역
- `i)`, `ib`
  - 괄호 내 범위
- `a}`, `aB`
  - 중괄호 영역
- `i}`, `iB`
  - 중괄호 내 범위
- `a]`
  - 대괄호 영역
- `i]`
  - 대괄호 내 범위
- `a>`
  - 꺽쇠 괄호 영역
- `i>`
  - 꺽쇠 괄호 내 범위
- `a'`
  - 따옴표 영역
- `i'`
  - 따옴표 내 범위
- `a"`
  - 겹따옴표 영역
- `i"`
  - 겹따옴표 내 범위
- ``` a\````
  - 역따옴표 영역
- ``` i\````
  - 역따옴표 내 범위
- `at`
  - xml 태그 영역
- `it`
  - xml 태그 내 범위

### 텍스트 객체로 오퍼레이터 사용하기

`d{motion}`, `t{motion}`, `y{motion}` => `d{text-object}`, `t{text-object}`, `y{text-object}`

### 토론

Tip.50, Tip.51

- `f{문자}` 명령으로 해당 문자가 나타나는 위치를 검색
- `/목표<CR>`으로 여러 문자를 검색
- 목표를 향해 "날라차기"하는 모습

텍스트 객체는 단 한번의 움직임으로 두 목표를 제압하는 "가위차기"에 비유할 수 있다.

## Tip.53 위치를 표시하고 그 위치로 이동하기

택스트 객체는 대부분 짝을 이룬다.
하나는 객체 내부를 대상으로 동작.
다른 하나는 객체를 감싸는 방법으로 동작한다.

Vim의 텍스트 객체는 동작 방식에 따라 두 종류로 분류할 수 있다.

1. 구분자 짝과 함께 동작하는 `i)`, `i"`, `it` 같은 객체
  - block
2. 단어, 문장, 문단과 같이 본문 단위를 기준으로 동작하는 객체
  - non-block

- word
  - iw 단어
  - aw 단어와 공백
- WORD
  - iW WORD
  - aW WORD와 공백
- 문장
  - is 문장
  - as 문장과 공백
- 문단
  - ip 문단
  - ap 문단과 빈 행

`iw` 텍스트 객체는 현재 단어의 첫 번째 문자부터 마지막 문자까지 영향을 미친다.
`aw` 텍스트 객체는 동일하지만 단어의 앞 또는 뒤에 빈칸이 존재한다면 그 빈칸까지 영역으로 사용한다.

`d{모션}` 을 사용할 때는 aw, as, ap 등을 사용
`c{모션}` 명령을 사용할 때는 iw와 같은 텍스트 객체를 사용하는 것이 일반적으로 적용할 수 있는 규칙이다.

## Tip.54 위치를 표시하고 그 위치로 이동하기

마크(mark)를 이용하면 문서 내에서 필요한 위치로 빠르게 이동할 수 있다.
수동으로 지정 가능, 자동으로 생성되는 마크를 이용할 수도 있다.

`m{a-zA-Z}` 명령을 사용하면 현재 커서 위치를 해당 문자에 마크로 저장할 수 있다. (`:h m` 참고)
소문자 마크의 경우 현재 파일 내에서만 이동할 수 있다.
대문자 마크는 전역적으로 접근이 가능하다.

마크로 이동하는 방법에는 두 가지 일반 모드 명령이 있다.

```'{마크}```는 마크로 표시한 행으로 이동해서 처음으로 공백이 아닌 문자가 나오는 곳에 커서를 놓는다.
``` `{마크} ``` 명령은 위치를 표시한 행과 열을 정확하게 찾아 그 위치로 커서를 이동한다. (`:h mark-motions` 참고)

`{마크} 를 우선적으로 기억하자.

`mm`과 ``m` 명령은 유용하게 사용할 수 있는 명령 짝이다.
m에 위치를 기록하고 이동할 수 있기 때문이다.

### 자동 위치 표시

Vim에서는 마크를 만드는 데 버퍼당 26개 소문자를 사용할 수 있다.

Vim에서는 마크 기능을 더 유용하게 사용할 수 있도록 자동으로 마크를 생성하는 기능도 있다.

- ``` `` ```: 현재 파일에서 마지막으로 이동하기 전 위치
- ``.`: 마지막 변경 위치
- ``^`: 마지막 삽입 위치
- ``[`: 마지막 변경 또는 복사의 시작 위치
- ``]`: 마지막 변경 또는 복사의 끝 위치
- ``<`: 마지막 선택 영역의 시작 위치
- ``>`: 마지막 선택 영역의 끝 위치

## Tip.55 괄호 넘나들기

`matchit.vim` 플러그인을 활성화하면 사용할 수 있다.

% 명령을 이용해서 열고 닫는 괄호로 이동할 수 있다. (`:h %` 참고)
(), {}, [] 모두 동작한다.

`motions/parentheses.rb`

### 키워드 사이 이동하기
