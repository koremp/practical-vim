# 6장 여러 파일 관리하기

Vim에서 여러 파일을 동시에 작업하는 것도 가능하다.

편집 세션에서 연 파일은 모두 버퍼 목록에서 확인할 수 있다.

Vim은 버퍼 목록을 보조하기 위해서 인자 목록도 제공한다.

* `:args` 명령으로 버퍼 목록에 있는 파일을 묶어 그룹으로 만들기
* `:argdo` 명령으로 그룹으로 만든 파일 목록을 살펴보는 방법과 각각 파일에서 Ex 명령을 실행

## Tip.37 버퍼 목록으로 열린 파일 추적하기

Vim은 여러 파일을 관리할 수 있도록 버퍼 목록을 제공한다.

### 파일과 버퍼의 차이점 이해하기

다른 문서 편집기처럼 Vim에서도 파일을 읽고, 편집하고, 변경 사항을 저장할 수 있다.
실제로는 파일을 편집하는 것이 아니다.

사실은 메모리 공간에 파일을 복사해서 편집을 하는 것이다. 이 메모리에 존재하는 파일의 사본을 Vim에서 사용하는 용어로 버퍼(buffer)라고 한다.

파일은 디스크에 보관하고 버퍼는 메모리에 보관한다. Vim에서 파일을 열면 파일과 동일한 내용을 버퍼에 불러온다.
처음에는 버퍼와 파일의 내용이 일치하지만 버퍼의 내용을 수정하는 순간부터는 내용이 달라진다.
만약 버퍼에서 변경한 사항을 유지하고 싶다면 버퍼의 내용을 다시 파일로 저장하면 된다.

Vim 명령은 대부분 버퍼에서 동작하지만 `:write`, `:update`, `:saveas` 명령처럼 파일을 조작하는 명령도 있다.

### 버퍼 목록 만나기

Vim에서는 동시에 버퍼를 여러 개 사용할 수 있다.

```sh
$ cd code/files
$ vim *.txt
```

`*.txt` 와일드 카드는 현재 디렉토리에 있던 파일 `a.txt`와 `b.txt`에 해당된다.

열려 있는 버퍼를 모두 확인하려면 다음 명령을 사용한다

`:ls`

`:ls` 명령으로 현재 메모리에 존재하는 모든 버퍼 목록을 확인할 수 있다. (`:h ls` 참고)

목록에서 다음 버퍼를 현재 창으로 불러오고 싶다면 `:bnext` 명령을 사용한다.

```vim
:bnext
:ls
```

버퍼 목록에서 `%` 기호는 현재 창에서 볼 수 있는 버퍼를 표시한다.
`#` 기호는 현재 활성된 버퍼와 교대한 버퍼를 나타낸다
`<C-^>` 단축키를 이용하면 현재 버퍼와 이전 버퍼를 빠르게 전환할 수 있다.

### 버퍼 목록 사용하기

Vim에서는 버퍼 목록을 이동하기 위한 네 가지 명령을 제공하고 있다.

`:bprev`, `:bnext`로 전후 이동, `:bfirst`, `:blast` 명령으로 목록의 처음과 끝으로 이동할 수 있다.

`unimpaired.vim` 플러그인에서 매핑을 사용하고 있다.

Vim에서는 이미 비슷한 기능을 하는 명령에 접두어로 `[`와 `]`를 사용하고 있다. (`:h [` 참고)

`:ls`로 목록을 출력해보면 각 버퍼 항목이 숫자로 시작하는 것을 확인할 수 있다.
이 숫자는 버퍼를 생성하면서 자동으로 배정되는 버퍼 번호이다.
이 숫자를 사용해서 `:buffer {버퍼번호}` 명령을 사용하면 그 숫자에 해당하는 버퍼로 바로 이동한다. (`:h :b` 참고)
`:buffer {버퍼명}`을 사용하면 더 직관적으로 사용할 수 있다.
`{버퍼명}`은 파일 경로를 기준으로 각각의 버퍼를 구분할 수 있는 명칭을 사용해야 한다.
입력한 버퍼명이 둘 이상인 경우에는 탭 완성을 사용해서 하나를 선택할 수 있다.

`:bufdo`를 사용하면 `:ls` 버퍼 목록에 있는 모든 버퍼를 대상으로 Ex 명령을 구동할 수 있다. (`:h :bufdo` 참고)
실제로는 `:argdo` 명령을 더 자주 사용하게 된다.

### 버퍼 제거하기

Vim에서는 파일을 새로 열 때마다 버퍼를 생성한다.
버퍼를 제거하고 싶다면 `:bdelete` 명령을 사용한다

사용 예시

* `:bdelete N1 N2 N3`
* `:N,M bdelete`
  * 5번 버퍼부터 10번 버퍼까지 연속된 버퍼를 제거하려면
  * `:5,10bd`

버퍼를 제거해도 버퍼와 연관된 실제 파일에는 영향을 미치지 않는다.
이 명령은 단순히 메모리 내 사본을 제거하는 기능을 한다.

버퍼 번호는 Vim이 자동으로 배정한다.

버퍼 목록을 관리하는 Vim의 내장 기능은 유연성이 부족한 편이다.
이 버퍼 목록을 다시 조정하는 기능이 없다.
대신 작업 환경을 창이나 탭, 인자 목록으로 나눠서 관리할 수 있다.

## Tip.38 인자 목록으로 버퍼 묶음 관리하기

인자 목록은 일련의 파일을 쉽게 이동하고 관리하기 위해 그룹으로 묶는 기능을 제공한다.
`:argdo` 명령을 사용하면 인자 목록에 있는 각각의 파일 항목에서 Ex 명령을 실행할 수 있다.

```sh
$ cvd code/files/letters
$ vim *.txt
:args
```

인자 목록은 Vim을 실행할 때, 인자로 사용한 파일 목록을 확인할 수 있는  기능이다.
출력된 인자 목록에서 볼 수 있는 [] 문자는 인자 목록에서 현재 어느 파일이 열려 있는지 표시한다.

`:ls`명령의 결과와 인자 목록을 비교해보면 입력한 그대로의 모습을 출력한 것이나 마찬가지라는 사실을 알 수 있다.
`:args`의 목록은 Vim을 실행할 당시의 인자를 항상 반영하는 것은 아니다.
기능의 명칭을 그대로 받아들이지 말자.
`:compiler`와 `:make`는 컴파일 언어만을 위한 것이 아니다.

### 인자 목록 출력하기

`:args` Ex 명령을 인자 없이 실행하면 인자 목록에 있는 내용을 출력할 것이다.
인자 목록을 갱신할 수 있다. (`:h :args_f` 참고)

`:args {인자목록}`

`{인자목록}`은 파일명이나 와일드카드, 셸 명령의 출력을 포함할 수 있다.

```sh
$ cd code/files/mvc
$ vim
```

### 이름으로 파일 지정하기

인자 목록에 파일명을 입력하는 가장 간단한 방법은 다음처럼 하나씩 직접 입력하는 방식이다.

```vim
-> :args index.html app.js
-> :args
```

버퍼에서 활용하고 싶은 파일이 몇 개 되지 않는다면 이 방법을 사용해도 된다.
이 방법은 순서를 마음대로 정할 수 있다는 장점이 있다.
직접 입력하는 과정이 수고스럽다는 단점이 있다.

### 글롭(Glob)으로 파일 지정하기

플레이스홀더(placeholder)는 파일이나 디렉터리명을 전부 입력하지 않고도 인자 목록에 파일을 입력할 수 있다.
와일드카드를 플레이스홀더로 사용해서 여러 파일을 동시에 불러올 수 있다.
`*` 기호는 파일명에 문자가 없거나 하나 이상 존재하는 경우를 의미하며, 정해진 딜렉터리 영역 내에서만 동작한다. (`:h wildcard` 참고)

`**` 와일드카드도 팡리명에 문자가 없거나 하나 이상 존재하는 경우를 뜻한다.
특정 디렉터리 안에 존재하는 부 디렉터리까지 모두 재귀적으로 검색해서 파일을 찾는다. (`:h starstar-wildcard` 참고)

요청한 경로와 일치하는 파일 목록을 불러오기 위해 와일드카드 조합해서 파일명 또는 디렉터리명의 형태를 기준으로 모든 파일을 불러올 수 있다.
요청한 경로와 일치하는 파일 목록을 불러오기 위해 와일드카드 조합을 사용할 수 있는데, 이 방법을 글롭(glob)이라고 한다.

글롭
* `:args *.*`: index.html, app.js
* `:args **/*.js`: app.js, lib/framework.js, app/controllers/Mailer.js, ... etc
* `:args **/*.*`: app.js, index.js, lib/theme.css, etc

`{인자목록}`에는 하나 이상의 파일명을 사용할 수 있기 때문에, 여러 개의 글롭을 동시에 요청할 수 있다.

`:args **/*.js **/*.css`

### 역따옴표 확장으로 파일 지정하기

`files/.chapters`

문서로 작성한 파일 목록을 인자 목록으로 불러오기 위해서는 다음의 명령을 사용할 수 있다.

```vim
:args `cat .chapters`
```

Vim은 역따옴표 내에 있는 문자들을 셸 명령으로 처리하고 그 결과를 `:args` 명령의 인자로 사용한다.

위에서 사용한 명령은 셸의 `cat` 명령과 조합해서 `.chapters` 파일의 내용을 인자 목록으로 반환한다. 여기서는 `.chapters` 파일의 내용을 가져오기 위해서 `cat` 명령을 사용했지만 셸에서 구동할 수 있는 명령은 어떤것이든 인자 목록 명령과ㅏ 함께 사용할 수 있다.

이 기능은 모든 시스템에서 동작하지는 않는다. (`:h backtick-expansion` 참고)

### 인자 목록 사용하기

인자 목록은 버퍼 목록보다 간단하다.

파일을 필요에 따라 마음대로 묶어서 관리할 수도 있다.

`:args {인자목록}` 명령을 이용하면 인자 목록을 비우고 다시 입력할 수 있다.
`:next`와 `:prev` 명령을 이용해서 인자 목록에 있는 다음 또는 이전 파일을 버퍼로 불러내는 것도 가능하다.
`:argdo`로 인자 목록의 각각 버퍼에 동일한 명령을 실행할 수 있다

버퍼 목록은 언제나 난장판이 된다.
인자 목록을 활용하면 마치 분리된 작업 공간처럼 각 환경을 단정하게 유지할 수 있다.
필요에 따라 작업 공간을 확장하는 것도 가능하다.

## Tip.39 숨김 파일 관리하기




